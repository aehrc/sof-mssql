{
  "resourceType": "ViewDefinition",
  "id": "condition-diagnoses",
  "url": "http://example.org/fhir/ViewDefinition/condition-diagnoses",
  "version": "1.0.0",
  "name": "condition_diagnoses",
  "title": "Condition Diagnoses View",
  "status": "active",
  "experimental": false,
  "date": "2025-01-01",
  "publisher": "Example Healthcare Organisation",
  "description": "A tabular view of patient diagnoses from Condition resources, including onset, status, and coding information.",
  "resource": "Condition",
  "fhirVersion": ["4.0.1", "5.0.0"],
  "select": [
    {
      "column": [
        {
          "name": "condition_id",
          "path": "id",
          "type": "id",
          "description": "Condition resource identifier"
        },
        {
          "name": "patient_id",
          "path": "subject.reference.substring(8)",
          "type": "string",
          "description": "Patient identifier from reference"
        },
        {
          "name": "onset_date",
          "path": "onsetDateTime",
          "type": "dateTime",
          "description": "Date when condition started"
        },
        {
          "name": "abatement_date",
          "path": "abatementDateTime",
          "type": "dateTime",
          "description": "Date when condition resolved"
        },
        {
          "name": "clinical_status",
          "path": "clinicalStatus.coding.where(system = 'http://terminology.hl7.org/CodeSystem/condition-clinical').code.first()",
          "type": "code",
          "description": "Clinical status of the condition"
        },
        {
          "name": "verification_status",
          "path": "verificationStatus.coding.where(system = 'http://terminology.hl7.org/CodeSystem/condition-ver-status').code.first()",
          "type": "code",
          "description": "Verification status of the condition"
        }
      ]
    },
    {
      "forEach": "code.coding.where(system = 'http://snomed.info/sct').first()",
      "column": [
        {
          "name": "snomed_code",
          "path": "code",
          "type": "code",
          "description": "SNOMED CT code"
        },
        {
          "name": "snomed_display",
          "path": "display",
          "type": "string",
          "description": "SNOMED CT display text"
        }
      ]
    },
    {
      "column": [
        {
          "name": "condition_text",
          "path": "code.text",
          "type": "string",
          "description": "Human-readable condition description"
        }
      ]
    }
  ],
  "where": [
    {
      "path": "clinicalStatus.coding.where(system = 'http://terminology.hl7.org/CodeSystem/condition-clinical' and code != 'entered-in-error').exists()",
      "description": "Exclude conditions entered in error"
    }
  ]
}